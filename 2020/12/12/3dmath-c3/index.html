<!doctype html><html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta><title>《3D图形的数学》第3章笔记 变换 - 画码余生</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="画码余生"><meta name="msapplication-TileImage" content="/images/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="画码余生"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="3D游戏开发过程中，通常需要以某种方式对向量进行变换。"><meta property="og:type" content="blog"><meta property="og:title" content="《3D图形的数学》第3章笔记 变换"><meta property="og:url" content="https://yumi-cn.github.io/2020/12/12/3dmath-c3/"><meta property="og:site_name" content="画码余生"><meta property="og:description" content="3D游戏开发过程中，通常需要以某种方式对向量进行变换。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://yumi-cn.github.io/images/3d-math-c3-3-1.jpg"><meta property="og:image" content="https://yumi-cn.github.io/images/3d-math-c3-3-2.jpg"><meta property="og:image" content="https://yumi-cn.github.io/images/3dmath-c3-3.6.jpg"><meta property="og:image" content="https://yumi-cn.github.io/images/3dmath-c3-3.7.jpg"><meta property="og:image" content="https://yumi-cn.github.io/images/3d-math-c3-6-3.jpg"><meta property="og:image" content="https://yumi-cn.github.io/images/3d-math-c3-6-4.jpg"><meta property="og:image" content="https://yumi-cn.github.io/images/3d-math-c3-6-5.jpg"><meta property="article:published_time" content="2020-12-12T12:52:19.000Z"><meta property="article:modified_time" content="2020-12-12T15:18:18.379Z"><meta property="article:author" content="Yumiko"><meta property="article:tag" content="笔记"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/images/3d-math-c3-3-1.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://yumi-cn.github.io/2020/12/12/3dmath-c3/"},"headline":"画码余生","image":["https://yumi-cn.github.io/images/3d-math-c3-3-1.jpg","https://yumi-cn.github.io/images/3d-math-c3-3-2.jpg","https://yumi-cn.github.io/images/3dmath-c3-3.6.jpg","https://yumi-cn.github.io/images/3dmath-c3-3.7.jpg","https://yumi-cn.github.io/images/3d-math-c3-6-3.jpg","https://yumi-cn.github.io/images/3d-math-c3-6-4.jpg","https://yumi-cn.github.io/images/3d-math-c3-6-5.jpg"],"datePublished":"2020-12-12T12:52:19.000Z","dateModified":"2020-12-12T15:18:18.379Z","author":{"@type":"Person","name":"Yumiko"},"description":"3D游戏开发过程中，通常需要以某种方式对向量进行变换。"}</script><link rel="canonical" href="https://yumi-cn.github.io/2020/12/12/3dmath-c3/"><link rel="alternate" href="/atom.xml" title="画码余生" type="application/atom+xml"><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.2.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/logo.jpg" alt="画码余生" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">文章</a><a class="navbar-item" href="/categories">专栏</a><a class="navbar-item" href="/tags">主题</a><a class="navbar-item" href="/about">关于我</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Github" href="https://github.com/yumi-cn"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2020-12-12T12:52:19.000Z" title="2020-12-12T12:52:19.000Z">2020-12-12</time>发表</span><span class="level-item"><time datetime="2020-12-12T15:18:18.379Z" title="2020-12-12T15:18:18.379Z">2020-12-12</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/3D%E6%B8%B8%E6%88%8F%E4%B8%8E%E5%9B%BE%E5%BD%A2%E5%AD%A6%E7%9A%84%E6%95%B0%E5%AD%A6/">3D游戏与图形学的数学</a></span><span class="level-item">44 分钟读完 (大约6538个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">《3D图形的数学》第3章笔记 变换</h1><div class="content"><blockquote><p>3D游戏开发过程中，通常需要以某种方式对向量进行变换。</p></blockquote><a id="more"></a><p>通常用到的变换包括<strong>平移、缩放和旋转</strong>。</p><h2 id="1-通用变换"><a href="#1-通用变换" class="headerlink" title="1 通用变换"></a>1 通用变换</h2><p>通常把 \(n \times n\) 可逆矩阵M看成是一个从坐标系到另一个坐标系的变换矩阵。</p><p>M的列给出了坐标轴从原坐标系到新坐标系的映射；\(M^{-1}\)的列给出了坐标轴从新坐标系到原坐标系的映射。</p><p>PS：书上的上面两句话，可以尝试从M乘以一个坐标轴单位向量的结果角度来考量，也就理解M的列是如何对一个向量或者坐标的各个轴的处理的。</p><p>多个变换可以串联起来，也可以将多个变换矩阵的乘积用一个矩阵来表示，例如 \(G(MP)=(GM)P\)，其中G/M是变换矩阵，P是坐标或向量，先做M变换再做G变换的结果可以用一个(GM)矩阵来存储，这样可以对顶点做无数次的变换，不需要额外的存储空间和计算开销。</p><h3 id="1-1-正交矩阵"><a href="#1-1-正交矩阵" class="headerlink" title="1.1 正交矩阵"></a>1.1 正交矩阵</h3><p><strong>正交矩阵的转置等于其逆矩阵</strong>。</p><p><strong>【定义3.1】</strong> 一个n阶可逆方阵M，当且仅当 \(M^{-1}=M^{T}\)时，M为正交矩阵。</p><p><strong>【定理3.2】</strong> 如果向量组 \(V_{1}, V_{2}, \cdots, V_{n}\)构成的一个正交向量集合，则以 \(V_{j}, (1 \leq j \leq n)\)作为第j列的n阶方阵是正交矩阵。</p><p>正交矩阵还有另外一个性质，用于变换向量时，<strong>正交矩阵不改变向量的长度和角度</strong>（一般指的是两个同样变换的向量夹角）。</p><p><strong>【定理3.3】</strong> 如果n阶方阵M正交，则M具有保证长度和角度不变的特性。</p><p>Tips：证明可以先从不改变两个向量的内积入手，然后再说明对单个向量不改变长度，再推出不改变角度。</p><p>由于这样的特性，使用正交矩阵变换可以保持坐标系的整体结构，所以正交矩阵只能用于表示旋转和反射（在某一方向上将点镜像的运算）的组合。</p><h3 id="1-2-手向性"><a href="#1-2-手向性" class="headerlink" title="1.2 手向性"></a>1.2 手向性</h3><p>在三维空间中，由3D向量 \(V_{1}, V_{2}, V_{3}\) 构成的坐标系的基具有手向性。对于<strong>右手基</strong>，有 \((V_{1} \times V_{2}) \cdot V_{3} &gt; 0\)，即在右手坐标系中， \(V_{1}, V_{2}\)的叉积(右手法则下)的方向与 \(V_{3}\)的方向形成一个锐角，如果是一个<strong>正交规范的右手基</strong>，则有 \(V_{1} \times V_{2} = V_{3}\)；若\((V_{1} \times V_{2}) \cdot V_{3} &lt; 0\)，那么是<strong>左手基</strong>。</p><p>进行<strong>奇数次的反射操作</strong>，会改变手向性，<strong>偶数次的反射</strong>相当与一次旋转。通过考查变换矩阵的行列式可以判定矩阵是否存在反射，若<strong>行列式为负</strong>，则存在反射，用其对任意基的向量进行变换操作后，基的手向性发生改变。如果行列式是正的，则不改变手向性。</p><p>另外，正交矩阵的行列式值只可能是1或-1，如果为1，则矩阵只有旋转；如果为-1，则表示旋转操作后再进行一次反射。</p><hr><h2 id="2-缩放变换"><a href="#2-缩放变换" class="headerlink" title="2 缩放变换"></a>2 缩放变换</h2><p>用a作为系数缩放向量P，只需要计算 \(P^{‘}=aP\)，在三维空间中，运算也可以表示为和矩阵的乘积：</p><div>$$ P^{'} = \left[ \begin{matrix} a & 0 & 0 \\ 0 & a & 0 \\ 0 & 0 & a \end{matrix} \right] \left[ \begin{matrix} P_{x} \\ P_{y} \\ P_{z} \end{matrix} \right] \tag{3.8} $$</div><p>这种缩放成为<strong>统一缩放</strong>（各个轴相同缩放系数），如果希望在x,y,z轴以不同的值缩放向量，可以改变对角线上的元素（不再是相同的一个a），这种缩放称为<strong>非统一缩放</strong>。</p><div>$$ P^{'} = \left[ \begin{matrix} a & 0 & 0 \\ 0 & b & 0 \\ 0 & 0 & c \end{matrix} \right] \left[ \begin{matrix} P_{x} \\ P_{y} \\ P_{z} \end{matrix} \right] \tag{3.9} $$</div><p>如果想在<strong>3个任意轴上进行非统一缩放</strong>，就要用到稍微复杂的缩放过程。假设以a,b,c为系数，在U,V,W轴方向上进行缩放，就需要先从坐标系(U,V,W)变换到坐标系(i,j,k) （这一步乘以[U V W]的逆矩阵变换到UVW为ijk坐标轴的空间中），然后在(i,j,k)坐标系中计算缩放（乘以缩放矩阵），最后再还原到(U,V,W)坐标系（乘以[U V W]矩阵变换到原本的ijk坐标轴空间中）。</p><div>$$ P^{'} = \left[ \begin{matrix} U_{x} & V_{x} & W_{x} \\ U_{y} & V_{y} & W_{y} \\ U_{z} & V_{z} & W_{z} \end{matrix} \right] \left[ \begin{matrix} a & 0 & 0 \\ 0 & b & 0 \\ 0 & 0 & c \end{matrix} \right] \left[ \begin{matrix} U_{x} & V_{x} & W_{x} \\ U_{y} & V_{y} & W_{y} \\ U_{z} & V_{z} & W_{z} \end{matrix} \right]^{-1} \left[ \begin{matrix} P_{x} \\ P_{y} \\ P_{z} \end{matrix} \right] \tag{3.10} $$</div><p>Tips：这一段其实说的有点绕，但其实理解第一步就可以理解后面了，关于为什么是乘以逆矩阵，是因为(U,V,W)中的目标 \(P^{uvw}\) 有以下的表示方法：</p><div>$$ P^{uvw}_{x} \left[ \begin{matrix} U_{x} \\ U_{y} \\ U_{z} \end{matrix} \right] + P^{uvw}_{y} \left[ \begin{matrix} W_{x} \\ W_{y} \\ W_{z} \end{matrix} \right] + P^{uvw}_{z} \left[ \begin{matrix} V_{x} \\ V_{y} \\ V_{z} \end{matrix} \right] \\ = \left[ \begin{matrix} U_{x} & V_{x} & W_{x} \\ U_{y} & V_{y} & W_{y} \\ U_{z} & V_{z} & W_{z} \end{matrix} \right] \left[ \begin{matrix} P^{uvw}_{x} \\ P^{uvw}_{y} \\ P^{uvw}_{z} \end{matrix} \right] = \left[ \begin{matrix} P_{x} \\ P_{y} \\ P_{z} \end{matrix} \right] $$</div><p>所以要求得(U,V,W)坐标系下的坐标 \(P^{uvw}\) 就要用原坐标乘以矩阵[U V W]的逆矩阵：</p><div>$$ \left[ \begin{matrix} P^{uvw}_{x} \\ P^{uvw}_{y} \\ P^{uvw}_{z} \end{matrix} \right] = \left[ \begin{matrix} U_{x} & V_{x} & W_{x} \\ U_{y} & V_{y} & W_{y} \\ U_{z} & V_{z} & W_{z} \end{matrix} \right]^{-1} \left[ \begin{matrix} P_{x} \\ P_{y} \\ P_{z} \end{matrix} \right] $$</div><p>这也就解释了第一步为什么乘以的是逆矩阵，后面也就相同的方法来解释了。</p><hr><h2 id="3-旋转变换"><a href="#3-旋转变换" class="headerlink" title="3 旋转变换"></a>3 旋转变换</h2><p>得到将坐标系绕x,y或z轴旋转 \(\theta\)角的矩阵并不难，当A轴指向我们时，所看到的旋转时逆时针方向。</p><p>首先看一下二维空间旋转的通用公式，如图3.2所示，通过交换x和y坐标，并将新的x坐标取负，得到(-y,x)，就能够将位于xy平面线上的二维向量P进行90°的逆时针旋转。设旋转向量为Q，则有 \( Q=&lt;-P_{y}, P_{x}&gt;\)。向量P和Q组成了xy平面的一个正交基，因此xy平面的任意向量都可以用这两个向量的线性组合来表示。</p><div align="center"><p><img src="/images/3d-math-c3-3-1.jpg"></p></div><p>如图3.3所示，任意向量P以 \(\theta\)角旋转后所形成的二维向量 \(P^{‘}\)，都可以用分别平行于P和Q的分量来表示。</p><div>$$ P^{'} = Pcos\theta + Qsin\theta \tag{3.11} $$</div><p>带入Q的坐标计算，可以有：</p><div>$$ \begin{aligned} P^{'}_{x} &= P_{x}cos\theta - P_{y}sin\theta \\ P^{'}_{y} &= P_{y}cos\theta + P_{x}sin\theta \end{aligned} \tag{3.12} $$</div><p>用矩阵改写则有：</p><div>$$ P^{'} = \left[ \begin{matrix} cos\theta & -sin\theta \\ sin\theta & cos\theta \end{matrix} \right] P \tag{3.13} $$</div><p>将单位矩阵的第3行和第3列加入到等式3.13中的2D旋转矩阵，就可以扩展成3D空间中绕z轴的三维旋转，在旋转过程中z坐标保持不变，绕z轴旋转 \(\theta\) 角度的旋转矩阵 \(R_{z}(\theta)\)可以表示为：</p><div>$$ R_{z}(\theta) = \left[ \begin{matrix} cos\theta & -sin\theta & 0 \\ sin\theta & cos\theta & 0 \\ 0 & 0 & 1 \end{matrix} \right] \tag{3.14} $$</div><p>同样，可以分别得到绕x轴和绕y轴旋转\theta角度的旋转矩阵 \(R_{x}(\theta)\) 和 \(R_{y}(\theta)\)：</p><div>$$ \begin{aligned} R_{x}(\theta) = \left[ \begin{matrix} 1 & 0 & 0 \\ 0 & cos\theta & -sin\theta \\ 0 & sin\theta & cos\theta \end{matrix} \right] \\ R_{y}(\theta) = \left[ \begin{matrix} cos\theta & 0 & sin\theta \\ 0 & 1 & 0 \\ -sin\theta & 0 & cos\theta \end{matrix} \right] \end{aligned} \tag{3.15} $$</div><h3 id="3-1-绕任意轴旋转"><a href="#3-1-绕任意轴旋转" class="headerlink" title="3.1 绕任意轴旋转"></a>3.1 绕任意轴旋转</h3><p>如果如果希望将向量P绕一个<strong>任意轴旋转</strong> \(\theta\) 角，选定的任意轴以单位向量A表示，那么可以先将向量P分解为平行于A和垂直于A的分量。<br>如图3.4所示，由于平行分量在旋转过程中保持不变，所以只需要计算垂直于A的分量的旋转。</p><div align="center"><p><img src="/images/3d-math-c3-3-2.jpg"></p></div><p>A是一个单位向量，P在A上地投影为（公式1.18）：</p><div>$$ proj_{A}P = \frac{P \cdot A}{A^{2}} A = (P \cdot A)A \tag{3.16} $$</div><p>P垂直于A的分量为（公式1.19）：</p><div>$$ perp_{A} P = P - proj_{A} P = P - (P \cdot A)A \tag{3.17} $$</div><p>将垂直于A的分量进行旋转，再加上平行分量，就得到最终的旋转结果。</p><p>垂直分量的旋转实在垂直于A轴的平面内进行的，平面中可以用垂直分量和垂直分量旋转90°所形成的向量组成一组正交基，就可以表达该平面内的任意向量，垂直分量旋转90°的向量可以用 \(A \times P\) 得到。</p><p>用下面的公式表示 \(perp_{A}P\)旋转 \(\theta\)角，即：</p><div>$$ [P - (P \cdot A)A]cos\theta + (A \times P)sin\theta \tag{3.18} $$</div><p>再加上平行分量 \(proj_{A}P\)，就可以得到P绕A轴旋转的公式：</p><div>$$ P^{'} = [P - (P \cdot A)A]cos\theta + (A \times P)sin\theta + (P \cdot A)A \\ = Pcos\theta + (A \times P)sin\theta + (P \cdot A)A(1 - cos\theta) \tag{3.19} $$</div><p>将其中的 \(A \times P\)和 \((P \cdot A)A\)替换为等价矩阵形式，就可以更加具体的表示出旋转矩阵 \(R_{A}(\theta)\)，公式过于繁杂就不再赘述。</p><h2 id="4-齐次坐标"><a href="#4-齐次坐标" class="headerlink" title="4 齐次坐标"></a>4 齐次坐标</h2><p>还有一个重要的变换是平移操作，在空间中平移坐标系，只需要简单地添加偏移向量，并不会影响坐标轴的方向和尺度，但这种矩阵无法用 \(3 \times 3\)的矩阵来直接表示，需要加一个平移分量：</p><div>$$ P^{'} = MP + T \tag{3.22} $$</div><p>M为可逆变换矩阵，T是平移向量。</p><h3 id="4-1-四维变换"><a href="#4-1-四维变换" class="headerlink" title="4.1 四维变换"></a>4.1 四维变换</h3><p>可以用一种统一的数学形式来简洁而优雅地表示这些变换（包含平移操作），为了做到这一点，需要将向量从三维扩展到四维，使用 \(4 \times 4\)矩阵来表示变换操作，给3D点P增加一个坐标，并将这个扩展的第四坐标(称为w坐标)的值设为1。</p><p>构造一个 \(4 \times 4\)变换矩阵F，F对应于变换矩阵M和3D平移变换T：</p><div>$$ F = \left[ \begin{matrix} M & T \\ 0 & 1 \end{matrix} \right] = \left[ \begin{matrix} M_{11} & M_{12} & M_{13} & T_{x} \\ M_{21} & M_{22} & M_{23} & T_{y} \\ M_{31} & M_{32} & M_{33} & T_{z} \\ 0 & 0 & 0 & 1 \end{matrix} \right] \tag{3.24} $$</div><p>这个矩阵乘以向量 \(P=&lt;P_{x}, P_{y}, P_{z}, 1&gt;\) 就等效于公式3.22，同时结果w坐标保持为1.</p><h3 id="4-2-点向量和方向向量"><a href="#4-2-点向量和方向向量" class="headerlink" title="4.2 点向量和方向向量"></a>4.2 点向量和方向向量</h3><p>Tips：书上把点坐标叫做点向量还是蛮奇怪的，就理解成点坐标就行了。</p><p>由于方向向量不会受平移变换的影响，所以在其扩展四维时，其w坐标设置为0（其实也可以从两个点坐标相减的角度理解，两个w相减就是0了），这个时候F矩阵中只有左上的 \(3 \times 3\) 部分可以影响方向向量。</p><h3 id="4-3-坐标的几何解释"><a href="#4-3-坐标的几何解释" class="headerlink" title="4.3 坐标的几何解释"></a>4.3 坐标的几何解释</h3><p>假设有一个四维点 \(P=&lt;x, y, z, w&gt;\)，其中坐标不为0，这里定义P在三维空间的映像，<br>如果用 \(\widetilde{P}\)表示P在 \(w=1\)的三维空间中的投影，\(\widetilde{P}\)可以用下面的公式来表示：</p><div>$$ \widetilde{P} = <\frac{x}{w}, \frac{y}{w}, \frac{z}{w}> \tag{3.28} $$</div><div align="center"><p><img src="/images/3dmath-c3-3.6.jpg" alt="图3.6 四维点P在三维空间的投影"></p></div><p>如图3.6所示（图中省略z轴为了方便表示），三维点 \(\widetilde{P}\) 对应于连接点P与原点的直线和 \(w=1\)的平面的交点，从这一点可以知道，对四维向量P作任意系数乘积，其结果都对应于三维空间中一个相同的点，在第4章5节中详细讨论这种投影在三维图形中的重要性。</p><h2 id="5-法向量的变换"><a href="#5-法向量的变换" class="headerlink" title="5 法向量的变换"></a>5 法向量的变换</h2><p>一个多边形模型的顶点除了需要表示空间位置外，还要包含一些附加信息，这些信息用来表示<strong>该顶点是如何融合到周围的曲面中的</strong>。一般情况下，顶点可能有<strong>切线向量</strong>和<strong>法线向量</strong>与之关联。<strong>当变换一个模型时，不但要变换顶点，同时还要对与顶点有关的向量进行变换</strong>。</p><p>可通过求两个顶点之间的差来计算<strong>切线向量</strong>，所以经过<strong>变换的切线向量</strong>可以表示为<strong>两个变换点的差</strong>。如果使用一个矩阵来变换顶点位置，也可以用这个矩阵来变换顶点的切向量。图3.7所示所示为用一个<strong>非正交矩阵M变换法向量N</strong>时发生的情况，变换后的法向量最终不垂直于变换后的表面。</p><div align="center"><p><img src="/images/3dmath-c3-3.7.jpg" alt="图3.7 用非正交矩阵M变换法向量"></p></div><p>因为切线方向和法线方向是垂直的，所以同一顶点的切向量T和法向量N必须满足等式 \(N \cdot T = 0\)，并且必须保证变换后的切向量 \(T^{‘}\)和法向量 \(N^{‘}\)仍然满足等式，设变换矩阵为M，有 \(T^{‘}=MT\)，设变换N所需的矩阵为G，有：</p><div>$$ N^{'} \cdot T^{'} = (GN) \cdot (MT) = 0 \tag{3.29} $$</div><p>经过简单的运算，可以得到：</p><div>$$ (GN) \cdot (MT) = (GN)^{T}(MT) = N^{T}G^{T}MT \tag{3.30} $$</div><p>由于 \(N^{T}T=0\)，如果 \(G^{T}M=I\)，则等式 \(N^{T}G^{T}MT\) 肯定成立。<br>因此可以得出 \(G=(M^{-1})^{T}\)。可以看出，用变换点的矩阵的逆转置矩阵，就能正确地变换法向量，<strong>必须通过这种方式变换的向量称为协变向量</strong>，用矩阵M以通常方式变换的向量（点或切向量）称为<strong>逆变向量</strong>。</p><p><strong>如果矩阵M是正交的</strong>，那么 \(M^{-1}=M^{T}\)，因此 \((M^{-1})^{T}=M\)，所以当M是正交矩阵时，<strong>法向量变换过程的求逆转置运算就可以避免</strong>，这一点适用于本章前面提到的当M等于旋转矩阵的情况。</p><h2 id="6-四元数"><a href="#6-四元数" class="headerlink" title="6 四元数"></a>6 四元数</h2><p>四元数是三维图像编程人员用来表示旋转的另一种数学形式。</p><p>在许多情况下，用四元数代替旋转矩阵会有很多的好处，因为四元数需要的存储空间更少，四元数之间的<strong>连接运算</strong>需要的算术运算更少，在产生平滑的三维动画时，用四元数更容易进行修改。</p><h3 id="6-1-四元数数学"><a href="#6-1-四元数数学" class="headerlink" title="6.1 四元数数学"></a>6.1 四元数数学</h3><p>四元数集合，被数学家们称为哈密顿四元数环(ring of Hamiltonian quaternions)，用H表示，可以理解为四维向量空间，空间中的元素q具有以下形式：</p><div>$$ q = [w, x, y, z] = w + xi + yj + zk \tag{3.31} $$</div><p>四元数经常写为 \(q=s+v\)的形式，其中s表示数量部分，对应于q中的w分量，v表示向量部分，对应于q中的x,y,z分量。</p><p>四元数集合是复数集合的自然扩展，四元数的乘法服从分配率，并且虚部i,j,k之间的乘法服从下面的规则：</p><div>$$ \begin{aligned} i^{2} &= j^{2} = k^{2} = -1 \\ ij &= -ji = k \\ jk &= -kj = i \\ ki &= -ik = j \end{aligned} \tag{3.32} $$</div><p>四元数式的乘法是不可交换的，因此运算要注意顺序。</p><p>两个四元数 \(q_{1}=w_{1}+x_{1}i+y_{1}j+z_{1}k\) 和 \(q_{2}=w_{2}+x_{2}i+y_{2}j+z_{2}k\) 的乘积 \(q_{1}q_{2}\) 为：</p><div>$$ q_{1}q_{2} = \\ (w_{1}w_{2} - x_{1}x_{2} - y_{1}y_{2} - z_{1}z_{2}) + \\ (w_{1}x_{2} + x_{1}w_{2} + y_{1}z_{2} - z_{1}y_{1})i + \\ (w_{1}y_{2} - x_{1}z_{2} + y_{1}w_{2} + z_{1}x_{2})j + \\ (w_{1}z_{2} + x_{1}y_{2} - y_{1}x_{2} + z_{1}w_{2})k \tag{3.33} $$</div><p>如果写成数量-向量形式，则 \(q_{1}=s_{1}+v_{1}\) 和 \(q_{2}=s_{2}+v_{2}\) 的乘积可以写成如下形式：</p><div>$$ q_{1}q_{2} = s_{1}s_{2} - v_{1} \cdot v_{2} + s_{1}v_{2} + s_{2}v_{1} + v_{1} \times v_{2} \tag{3.34} $$</div><p>和复数一样，四元数有共轭。</p><p><strong>【定义3.4】</strong> 四元数 \(q=s+v\)的共轭，记为 \(\bar{q}\)，定义为 \(\bar{q}=s-v\)。</p><p>通过简单的运算，就可以发现q与其共轭 \(\bar{q}\)的乘积等于q自身的点积，也就是等于q模的平方。</p><div>$$ q \bar{q} = \bar{q} q = q \cdot q = ||q||^{2} = q^{2} \tag{3.35} $$</div><p><strong>【定理3.5】</strong> 非零的四元数的逆，记为 \(q^{-1}\)，则有：</p><div>$$ q^{-1} = \frac{\bar{q}}{q^{2}} \tag{3.36} $$</div><h3 id="6-2-四元数的旋转"><a href="#6-2-四元数的旋转" class="headerlink" title="6.2 四元数的旋转"></a>6.2 四元数的旋转</h3><p>三维空间的旋转可以理解为 \(R^{3}\) 到自身 的映射函数 \(\varphi\)。由于\(\varphi\)代表旋转，所以它必须包含长度、角度、旋转方向等信息。如果有：</p><div>$$ ||\varphi(P)||=||P|| \tag{3.39} $$</div><p>则<strong>长度保持不变</strong>。</p><p>如果对任意两个点 \(P_{1}\) 和 \(P_{2}\)有：</p><div>$$ \varphi(P_{1}) \cdot \varphi(P_{2}) = P_{1} \cdot P_{2} \tag{3.40} $$</div><p>则从原点到两个点 \(P_{1}\) 和 \(P_{2}\)的连线所形成的<strong>夹角保持不变</strong>。</p><p>最后，如果：</p><div>$$ \varphi(P_{1}) \times \varphi(P_{2}) = \varphi(P_{1} \times P_{2}) \tag{3.41} $$</div><p>则<strong>手向性也保持</strong>不变。</p><p>如果满足条件 \(\varphi(s+v)=s+\varphi(v)\)，则函数 \(\varphi\)可以扩展为H到自身的映射，这样就允许将公式(3.40)重写为：</p><div>$$ \varphi(P_{1}) \cdot \varphi(P_{2}) = \varphi(P_{1} \cdot P_{2}) \tag{3.42} $$</div><p>如果将 \(P_{1}\)和 \(P_{2}\)看成是数量部分为0的四元数，根据 \(P_{1}P_{2} = -P_{1} \cdot P_{2} + P_{1} \times P_{2}\)，就可以将等式(3.41)和(3.42)合并成一个等式，在该等式中可以<strong>保持角度不变和手向性不变</strong>，公式如下：</p><div>$$ \varphi(P_{1})\varphi(P_{2}) = \varphi(P_{1}P_{2}) \tag{3.43} $$</div><p>满足这种等式的函数 \(\varphi\) 称为是<strong>同态</strong>的。</p><p>这一类函数可以用下面的公式给出：</p><div>$$ \varphi_{q}(P) = qPq^{-1} \tag{3.44} $$</div><p>其中q是一个非0的四元数，且满足等式(3.39)（长度不变）和(3.43)（角度不变、手向性不变），因此可以表示旋转的集合。</p><p>现在需要找到一个关于四元数q的公式，q对应于 \(\theta\)角绕A轴的旋转。<br>简单的计算表明 \(\varphi_{aq}=\varphi_{q}\) 适用于任何非零数量a，为了简单起见，只涉及单位四元数。设 \(q=s+v\) 是<strong>单位四元数</strong>，则 \(q^{-1}=s-v\)，对于给定的点P，有：</p><div>$$ \begin{aligned} qPq^{-1} &= (s + v)P(s - v) \\ &= (-v \cdot P + sP + v \times P)(s - v) \\ &= -sv \cdot P + s^{2}P + sv \times P + (v \cdot P)v - sPv - (v \times P)v \\ &= s^{2}P + 2sv \times P + (v \cdot P)v - v \times P \times v \end{aligned} \tag{3.47} $$</div><p>对叉积 \(v \times P \times v\) 使用定理1.9(6)，这个等式就变为：</p><div>$$ \begin{aligned} v \times (P \times v) = v \times P \times v = v^{2}P - (v \cdot P) v \\ qP^{-1}q = (s^{2}-v^{2})P + 2sv \times P + 2(v \cdot P)v \end{aligned} \tag{3.48} $$</div><p>设 \(v=tA\)，其中A为单位向量，则上式可改写为：</p><div>$$ qP^{-1}q = (s^{2}-v^{2})P + 2stA \times P + 2t^{2}(A \cdot P)A \tag{3.49} $$</div><p>比较等式(3.19)给出的绕任意轴旋转的公式，可以推出下面的等式：</p><div>$$ P^{'} = [P - (P \cdot A)A]cos\theta + (A \times P)sin\theta + (P \cdot A)A \\ = Pcos\theta + (A \times P)sin\theta + (P \cdot A)A(1 - cos\theta) \tag{3.19} $$</div><div>$$ \begin{aligned} s^{2} - t^{2} &= cos\theta \\ 2st &= sin\theta \\ 2t^{2} &= 1 - cos\theta \end{aligned} \tag{3.50} $$</div><p>由第三个等式可以得出：</p><div>$$ t = \sqrt{\frac{1-cos\theta}{2}} = sin\frac{\theta}{2} \tag{3.51} $$</div><p>结合式(3.50)中第一和第三个等式，可以得出 \(s^{2}+t^{2}=1\)，因此可以肯定 \(s=cos\frac{\theta}{2}\)。</p><p>现在可以用下面的等式给出对应于 \(\theta\)角绕A轴旋转的单位四元数q为：</p><div>$$ q = cos\frac{\theta}{2} + Asin\frac{\theta}{2} \tag{3.52} $$</div><p>这里应注意：四元数q的<strong>任意数量乘积</strong>(特别是-q)表示的是相同的旋转，这是因为之前说的\(\varphi_{aq}=\varphi_{q}\) 适用于任何非零数量a。</p><div>$$ (aq)P(aq)^{-1} = aqP \frac{q^{-1}}{a} = qP^{-1}q \tag{3.53} $$</div><p>两个四元数的乘积也可以表示一个旋转，乘积 \(q_{1}q_{2}\) 表示<strong>先以</strong> \(q_{2}\)，<strong>后以</strong> \(q_{1}\)进行旋转：</p><div>$$ q_{1}(q_{2}Pq_{2}^{-1})q_{1}^{-1} = (q_{1}q_{2})P(q_{1}q_{2})^{-1} \tag{3.54} $$</div><p>可以将任意多的四元数结合起来，形成表示一系列旋转的一个四元数，<br>将两个四元数相乘需要做16次乘法和加法运算，而两个 \(3 \times 3\) 矩阵相乘需要27次这样的操作，因此当对物体进行多次旋转时，应用四元数可以获得较高的计算效率。</p><p>经常需要将一个四元数变成等价的 \(3 \times 3\)旋转矩阵的形式。<br>利用等式(1.25)和(1.20)，可以确定对应于四元数 \(q = s + tA\)的矩阵公式。</p><div>$$ P \times Q = \left[ \begin{matrix} 0 & -P_{z} & P_{y} \\ P_{z} & 0 & -P_{x} \\ -P_{y} & P_{x} & 0 \end{matrix} \right] \left[ \begin{matrix} Q_{x} \\ Q_{y} \\ Q_{z} \end{matrix} \right] \tag{1.25} $$</div><div>$$ proj_{Q} P = \frac{1}{Q^{2}} \left[ \begin{matrix} Q_{x}^{2} & Q_{x}Q_{y} & Q_{x}Q_{z} \\ Q_{x}Q_{y} & Q_{y}^{2} & Q_{y}Q_{z} \\ Q_{x}Q_{z} & Q_{y}Q_{z} & Q_{z}^{2} \end{matrix} \right] \left[ \begin{matrix} P_{x} \\ P_{y} \\ P_{z} \end{matrix} \right] \tag{1.20} $$</div><p>然后将等式(3.49)改写成矩阵形式(和3.1节中用的技巧类似），由此可得：</p><div>$$ qPq_{-1} = \left[ \begin{matrix} s^{2}-t^{2} & 0 & 0 \\ 0 & s^{2}-t^{2} & 0 \\ 0 & 0 & s^{2}-t^{2} \end{matrix} \right]P + \\ 2st\left[ \begin{matrix} 0 & -A_{z} & A_{y} \\ A_{z} & 0 & -A_{x} \\ -A_{y} & A_{x} & 0 \end{matrix} \right]P + \\ 2t^{2}\left[ \begin{matrix} A_{x}^{2} & A_{x}A_{y} & A_{x}A_{z} \\ A_{x}A_{y} & A_{y}^{2} & A_{y}A_{z} \\ A_{x}A_{z} & A_{y}A_{z} & A_{z}^{2} \end{matrix} \right]P \tag{3.55} $$</div><p>将四元数p写成四维向量 \(q=&lt;w,x,y,z&gt;\)，那么 \(w=s, x=tA_{x}, y=tA_{y}, z=tA_{z}\)，因此A是单位向量，所以 \(x^{2}+y^{2}+z^{2} = t^{2}A^{2} = t^{2}\)，以 \(w,x,y,z\)为分量，则公式(3.55)可以改写为：</p><div>$$ qPq_{-1} = \left[ \begin{matrix} w^{2}-x^{2}-y^{2}-z^{2} & 0 & 0 \\ 0 & w^{2}-x^{2}-y^{2}-z^{2} & 0 \\ 0 & 0 & w^{2}-x^{2}-y^{2}-z^{2} \end{matrix} \right]P + \\ 2w\left[ \begin{matrix} 0 & -z & y \\ z & 0 & -x \\ -y & x & 0 \end{matrix} \right]P + \\ 2\left[ \begin{matrix} x^{2} & xy & xz \\ xy & y^{2} & yz \\ xz & yz & z^{2} \end{matrix} \right]P \tag{3.56} $$</div><p>因为q是单位四元数，满足 \(w^{2} + x^{2} + y^{2} + z^{2} = 1\)，所以有：</p><div>$$ w^{2} - x^{2} - y^{2} - z^{2} = 1 - 2x^{2} - 2y^{2} - 2z^{2} \tag{3.57} $$</div><p>根据该等式，并结合前面的三个矩阵，可以得到用来计算矩阵 \(R_{q}\) 的公式，这里的 \(R_{q}\) 表示对应于四元数q的旋转矩阵，公式为：</p><div>$$ R_{q} = \left[ \begin{matrix} 1-2y^{2}-2z^{2} & 2xy-2wz & 2xz+2wy \\ 2xy+2wz & 1-2x^{2}-2z^{2} & 2yz-2wx \\ 2xz-2wy & 2yz+2wx & 1-2x^{2}-2y^{2} \end{matrix} \right] \tag{3.58} $$</div><h3 id="6-3-球形线性插值"><a href="#6-3-球形线性插值" class="headerlink" title="6.3 球形线性插值"></a>6.3 球形线性插值</h3><p>因为四元数是用向量表示的，所以很适合于插值运算。<br>在产生一个物理动画的过程中，在产生位于两个预先计算的关键帧之间的中间过渡定位时，插值非常有用。</p><p>最简单的插值类型是<strong>线性插值</strong>，对于两个四元数 \(q_{1}\)和 \(q_{2}\)，线性插值后所得的四元数 \(q_{t}\)为：</p><div>$$ q(t) = (1-t)q_{1} + tq_{2} \tag{3.59} $$</div><p>当t在0和1之间变化时，函数 \(q(t)\)在连接 \(q_{1}\)和 \(q_{2}\)的线段上平滑变化。</p><div align="center"><p><img src="/images/3d-math-c3-6-3.jpg" alt="四元数的线性插值"></p></div><p>如上图所示，\(q(t)\)并不保持 \(q_{1}\)和 \(q_{2}\)的单位长度，但可以使用下面的函数在任意点位置对 \(q(t)\)进行重新规格化：</p><div>$$ q(t)=\frac{(1-t)q_{1} + tq_{2}}{||(1-t)q_{1} + tq_{2}||} \tag{3.60} $$</div><p>尽管线性插值是很有效的，但由等式(3.60)得出的函数 \(q(t)\)并没有以恒定的速率描绘 \(q_{1}\)和 \(q_{2}\)间的过渡弧线，这是线性插值的弊端。如下图所示，\(q_{1},q_{2}\)之间的角度变化速率在端点时相对较慢，在中间的地方最快。</p><div align="center"><p><img src="/images/3d-math-c3-6-4.jpg" alt="arccos(q(t)·q1)的曲线"></p></div><p>我们希望找到一个函数 \(q(t)\)，用它对四元数 \(q_{1}\)和 \(q_{2}\)进行插值时，<br>会保持其单位长度不变并且以恒定的速率扫过位于 \(q_{1}\)和 \(q_{2}\)之间的夹角。</p><p>如果 \(q_{1}\)和 \(q_{2}\)的夹角为 \(\theta\)，那么这个函数将会产生一个四元数，该四元数在 \(q(t)\)和 \(q_{1}\)之间形成一个夹角 \(\theta t\)，这里t在0在1之间取值。</p><p>如下图所示，四元数 \(q(t)\)位于连接 \(q_{1}\)和 \(q_{2}\)的弧上，与 \(q_{1}\)构成夹角 \(\theta t\)，与 \(q_{2}\)构成夹角 \(\theta(1-t)\)，可以将 \(q(t)\)写成：</p><div>$$ q(t) = a(t)q_{1} + b(t)q_{2} \tag{3.61} $$</div><div align="center"><p><img src="/images/3d-math-c3-6-5.jpg" alt="图(a)和图(b) 用相似三角形得到分量长度"></p></div><p>如图(a)所示，可以构造相似三角形来确定长度 \(a(t)\)，\(q_{1}\)到以原点和 \(q_{2}\)为端点的线段的垂直距离为 \(||q_{1}||sin\theta\)，而 \(q(t)\)到该线段的垂直距离为 \(||q(t)||sin(\theta(1-t))\)，根据相似三角形，可以由：</p><p>Tips：书上说的这个相似三角形在图(a)中并不明显，是以角 \(\theta\)为共同角，将边 \(||q(t)||sin(\theta(1-t))\) 平移到左边，构成的一个小三角形。</p><div>$$ \frac{a(t)}{||q(t)||sin(\theta(1-t))} = \frac{||q_{1}||}{||q||sin\theta} $$</div><p>所以有：</p><div>$$ \frac{a(t)}{||q_{1}||} = \frac{||q(t)||sin(\theta(1-t))}{||q||sin\theta} \tag{3.62} $$</div><p>由于 \(||q_{1}||=1\)，\(||q(t)||=1\)，可以将上式简化为：</p><div>$$ a(t) = \frac{sin(\theta(1-t))}{sin\theta} \tag{3.63} $$</div><p>图(b)表示了求长度 \(b(t)\)的相同过程，有结果：</p><div>$$ b(t) = \frac{sin(\theta t)}{sin\theta} \tag{3.64} $$</div><p>可以将球型线性插值函数 \(q(t)\)定义如下：</p><div>$$ q(t)= \frac{sin(\theta(1-t))}{sin\theta}q_{1} + \frac{sin(\theta t)}{sin\theta}q_{2} \tag{3.65} $$</div><p>这里的角 \(\theta\) 为：</p><div>$$ \theta = arccos(q_{1} \cdot q_{2}) \tag{3.66} $$</div><p>\(sin\theta\)计算：</p><div>$$ sin\theta = \sqrt{1-(q_{1} \cdot q_{2})^{2}} \tag{3.67} $$</div><p>因为四元数 \(q\) 和\(-q\)表示<strong>相同的旋转</strong>，所以选择四元数 \(q_{1}\)和 \(q_{2}\)的正负号时一般要满足 \(q_{1} \cdot q_{2} \geq 0\)，这样可以保证以最短路径的方式进行插值。</p></div><div class="article-licensing box"><div class="licensing-title"><p>《3D图形的数学》第3章笔记 变换</p><p><a href="https://yumi-cn.github.io/2020/12/12/3dmath-c3/">https://yumi-cn.github.io/2020/12/12/3dmath-c3/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Yumiko</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2020-12-12</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2020-12-12</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a></div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/images/zfb.jpg" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/images/wx.jpg" alt="微信"></span></a><a class="button donate" href="https://afdian.net/@yumiko-cn" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>爱发电</span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/12/20/s2o-c2-algorithm/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">《剑指Offer》第2章笔记 算法和数据操作</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/12/09/rtr-c1/"><span class="level-item">《实时渲染 4th》第1章笔记 导论</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.6.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.6.2/dist/gitalk.min.js"></script><script>var gitalk=new Gitalk({id:"f6d551f2d3cc5881c07b4fb6c135366b",repo:"yumi-cn.github.io",owner:"yumi-cn",clientID:"30141472b2ad1cb657d1",clientSecret:"80e26278051f7251bd46f5ec93317fec6675a7b4",admin:["yumi-cn"],createIssueManually:!1,distractionFreeMode:!1,perPage:20,pagerDirection:"last",enableHotKey:!0,language:"zh-CN"});gitalk.render("comment-container")</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/images/avatar.jpg" alt="Yumiko"></figure><p class="title is-size-4 is-block" style="line-height:inherit">Yumiko</p><p class="is-size-6 is-block">游戏/引擎/技美</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国 杭州</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">13</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">专栏</p><a href="/categories"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">主题</p><a href="/tags"><p class="title">1</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/yumi-cn" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/yumi-cn"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Bilibili" href="https://space.bilibili.com/11413916"><i class="fab fa-youtube"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Pixiv" href="https://www.pixiv.net/users/25096815"><i class="fas fa-palette"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">专栏</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/3D%E6%B8%B8%E6%88%8F%E4%B8%8E%E5%9B%BE%E5%BD%A2%E5%AD%A6%E7%9A%84%E6%95%B0%E5%AD%A6/"><span class="level-start"><span class="level-item">3D游戏与图形学的数学</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Real-Time-Rendering-4th/"><span class="level-start"><span class="level-item">Real Time Rendering 4th</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%89%91%E6%8C%87Offer/"><span class="level-start"><span class="level-item">剑指Offer</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AE%A1%E5%88%92-Flags/"><span class="level-start"><span class="level-item">计划-Flags</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2020-12-20T05:57:08.000Z">2020-12-20</time></p><p class="title"><a href="/2020/12/20/s2o-c2-algorithm/">《剑指Offer》第2章笔记 算法和数据操作</a></p><p class="categories"><a href="/categories/%E5%89%91%E6%8C%87Offer/">剑指Offer</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-12-12T12:52:19.000Z">2020-12-12</time></p><p class="title"><a href="/2020/12/12/3dmath-c3/">《3D图形的数学》第3章笔记 变换</a></p><p class="categories"><a href="/categories/3D%E6%B8%B8%E6%88%8F%E4%B8%8E%E5%9B%BE%E5%BD%A2%E5%AD%A6%E7%9A%84%E6%95%B0%E5%AD%A6/">3D游戏与图形学的数学</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-12-09T11:12:14.000Z">2020-12-09</time></p><p class="title"><a href="/2020/12/09/rtr-c1/">《实时渲染 4th》第1章笔记 导论</a></p><p class="categories"><a href="/categories/Real-Time-Rendering-4th/">Real Time Rendering 4th</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-12-07T12:18:45.000Z">2020-12-07</time></p><p class="title"><a href="/2020/12/07/s2o-c2-tree/">《剑指Offer》第2章笔记 树</a></p><p class="categories"><a href="/categories/%E5%89%91%E6%8C%87Offer/">剑指Offer</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-12-07T12:17:27.000Z">2020-12-07</time></p><p class="title"><a href="/2020/12/07/s2o-c2-stk-queue/">《剑指Offer》第2章笔记 栈和队列</a></p><p class="categories"><a href="/categories/%E5%89%91%E6%8C%87Offer/">剑指Offer</a></p></div></article></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#1-通用变换"><span class="level-left"><span class="level-item">1 通用变换</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-1-正交矩阵"><span class="level-left"><span class="level-item">1.1 正交矩阵</span></span></a></li><li><a class="level is-mobile" href="#1-2-手向性"><span class="level-left"><span class="level-item">1.2 手向性</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-缩放变换"><span class="level-left"><span class="level-item">2 缩放变换</span></span></a></li><li><a class="level is-mobile" href="#3-旋转变换"><span class="level-left"><span class="level-item">3 旋转变换</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#3-1-绕任意轴旋转"><span class="level-left"><span class="level-item">3.1 绕任意轴旋转</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-齐次坐标"><span class="level-left"><span class="level-item">4 齐次坐标</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-1-四维变换"><span class="level-left"><span class="level-item">4.1 四维变换</span></span></a></li><li><a class="level is-mobile" href="#4-2-点向量和方向向量"><span class="level-left"><span class="level-item">4.2 点向量和方向向量</span></span></a></li><li><a class="level is-mobile" href="#4-3-坐标的几何解释"><span class="level-left"><span class="level-item">4.3 坐标的几何解释</span></span></a></li></ul></li><li><a class="level is-mobile" href="#5-法向量的变换"><span class="level-left"><span class="level-item">5 法向量的变换</span></span></a></li><li><a class="level is-mobile" href="#6-四元数"><span class="level-left"><span class="level-item">6 四元数</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#6-1-四元数数学"><span class="level-left"><span class="level-item">6.1 四元数数学</span></span></a></li><li><a class="level is-mobile" href="#6-2-四元数的旋转"><span class="level-left"><span class="level-item">6.2 四元数的旋转</span></span></a></li><li><a class="level is-mobile" href="#6-3-球形线性插值"><span class="level-left"><span class="level-item">6.3 球形线性插值</span></span></a></li></ul></li></ul></div></div><script src="/js/toc.js" defer></script></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/logo.jpg" alt="画码余生" height="28"></a><p class="is-size-7"><span>&copy; 2020 Yumiko</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="GitHub" href="https://github.com/yumi-cn"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" async></script><script>moment.locale("zh-CN")</script><script>var IcarusThemeSettings={article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/mhchem.js" defer></script><script>window.addEventListener("load",function(){document.querySelectorAll('[role="article"] > .content').forEach(function(e){renderMathInElement(e)})})</script><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener("DOMContentLoaded",function(){loadInsight({contentUrl:"/content.json"},{hint:"想要查找什么...",untitled:"(无标题)",posts:"文章",pages:"页面",categories:"专栏",tags:"主题"})})</script></body></html>